(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{143:function(e,t,a){},144:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(47),r=a.n(c),l=(a(58),a(4)),i=(a(59),a(1)),s=a.n(i),m=(a(12),a(20)),u="_start";s.a.apps.length?s.a.app():s.a.initializeApp({apiKey:"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg",authDomain:"private-school-chat.firebaseapp.com",databaseURL:"https://private-school-chat.firebaseio.com",projectId:"private-school-chat",storageBucket:"private-school-chat.appspot.com",messagingSenderId:"113930891891",appId:"1:113930891891:web:88a3cb1a24e25b06017006"});var p=s.a.firestore();function d(){var e=p.collection("rooms").orderBy("createdAt"),t=Object(m.a)(e,{idField:"id"}),a=Object(l.a)(t,1)[0];return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"roomList"},o.a.createElement("div",{className:"overlaytex"},"Select a room"),a&&a.map((function(e){return o.a.createElement(h,{key:e.id,message:e})}))))}function h(e){var t=e.message,a=t.roomName,n=t.roomSysName;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){u=n,a,window.location.replace("/p-chat/?room="+n)}},a)))}var g=function(){var e=new URLSearchParams(window.location.search).get("room");return console.log(e),u=e,o.a.createElement("div",{id:"overlay"},o.a.createElement("div",{id:"overlayText"},o.a.createElement(d,null)))};a(23);s.a.apps.length?s.a.app():s.a.initializeApp({apiKey:"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg",authDomain:"private-school-chat.firebaseapp.com",databaseURL:"https://private-school-chat.firebaseio.com",projectId:"private-school-chat",storageBucket:"private-school-chat.appspot.com",messagingSenderId:"113930891891",appId:"1:113930891891:web:88a3cb1a24e25b06017006"});var f=s.a.auth();function v(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{className:"sign-in",onClick:function(){var e=new s.a.auth.GoogleAuthProvider;f.signInWithPopup(e)}},"Sign In"),o.a.createElement("div",{className:"opening-text"},"If you cannot sign in, please check your pop-up blocker and internet connection."))}function E(){return f.currentUser&&o.a.createElement("button",{className:"sign-out",onClick:function(){f.signOut()}},"Sign Out")}var b=a(31),y=a.n(b),I=a(48);a(145);s.a.apps.length?s.a.app():s.a.initializeApp({apiKey:"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg",authDomain:"private-school-chat.firebaseapp.com",databaseURL:"https://private-school-chat.firebaseio.com",projectId:"private-school-chat",storageBucket:"private-school-chat.appspot.com",messagingSenderId:"113930891891",appId:"1:113930891891:web:88a3cb1a24e25b06017006"});var w="";var S=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],c=t[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"imgurUpload"},o.a.createElement("div",{id:"imgurUploadInner"},o.a.createElement("h2",null,"Upload image"),o.a.createElement("form",null,o.a.createElement("input",{type:"file",className:"input-image",onChange:function(){var e=document.getElementsByClassName("input-image")[0].files[0],t=s.a.storage().ref();console.log(e.type);var a=Math.floor(69696969*Math.random()+1);c("Uploading!"),t.child("images/"+a).put(e).then((function(e){e.ref.getDownloadURL().then((function(e){w=e,c("File uploaded! The next message you send will have this attachment, refresh now to cancel!")}))}))}})),o.a.createElement("p",null,a),o.a.createElement("button",{onClick:function(){document.getElementById("imgurUpload").style.display="none"}},"Close"))),o.a.createElement("button",{onClick:function(){document.getElementById("imgurUpload").style.display="block"}},o.a.createElement("span",{role:"img","aria-label":"Attatch file"},"\u2b06")))},N=a(49),j=a.n(N),C=[],U=[],B=0,A=[];s.a.apps.length?s.a.app():s.a.initializeApp({apiKey:"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg",authDomain:"private-school-chat.firebaseapp.com",databaseURL:"https://private-school-chat.firebaseio.com",projectId:"private-school-chat",storageBucket:"private-school-chat.appspot.com",messagingSenderId:"113930891891",appId:"1:113930891891:web:88a3cb1a24e25b06017006"});var k=s.a.auth();var L=function(e){var t,a=Object(n.useRef)(),c=e.message,r=c.text,i=c.uid,s=c.photoURL,m=c.createdAt,u=c.name,p=c.attatchment,d=i===k.currentUser.uid?"sent":"received",h=Object(n.useState)(!1),g=Object(l.a)(h,2),f=g[0],v=g[1],E=B;C.push(d),U.push(m),A.push(i),B+=1,console.log(C),console.log(U),console.log(A),console.log(E),"received"===d&&(f||(H.play(),v(!0),Y||(messagesSinceLastOpen+=1,document.title="("+messagesSinceLastOpen+") Planner",document.getElementById("favicon").href="/p-chat/favicon-unread.ico"))),Object(n.useEffect)((function(){if(!(E<1||"Sending..."===b)){if(void 0!==m&&null!==U[E-1]&&void 0!==U[E-1])var e=Math.floor((m.toDate()-U[E-1].toDate())/1e3/60);if(d===C[E-1]&&A[E-1]===i&&e<1){var t=document.getElementById("timestamp"+(E-1));try{t.style.display="none",console.log("Changed")}catch(a){}}}})),void 0!==u?u!==k.currentUser.displayName?t=u+" \u2022 ":(t="You \u2022 ","Ciara Lee"===u&&(t="You, aka the cutest person ever \u2022 ")):t="Name missing \u2022 ";var b="Sending...",y="";if(null!=m){var I=(b=new Date(m.toDate())).toTimeString().split(":"),w=" ";if(I[0]>=13){var S=parseInt(I[0]);S-=12,I[0]=S.toString(),w="PM"}else w="AM";b="".concat(b.toDateString(),"  ").concat(I[0],":").concat(I[1]," ").concat(w)}return y="sent"===d?"tssent":"tsreceived",o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"message ".concat(d)},o.a.createElement("img",{alt:"Profile",src:s||"https://hideyboi.github.io/p-chat/missingProfilePicture.png"}),"Sending..."===b?o.a.createElement("img",{alt:"sending",src:"/p-chat/loading.gif"}):o.a.createElement(o.a.Fragment,null,r?o.a.createElement("div",{className:"MessageContainer"},o.a.createElement("div",{className:"messageText"},o.a.createElement(j.a,null,r))):o.a.createElement("span",null))),p?o.a.createElement("div",{className:"attatchmentContainer "+d},o.a.createElement("a",{className:"attatchment",href:p,target:"_empty",alt:"Open Attatchment in new tab"},o.a.createElement("img",{alt:"attatchment",src:p}))):o.a.createElement("span",null),o.a.createElement("div",{id:"timestamp"+E,className:"timestamp ".concat(y)},t,b),o.a.createElement("span",{ref:a}))};s.a.apps.length?s.a.app():s.a.initializeApp({apiKey:"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg",authDomain:"private-school-chat.firebaseapp.com",databaseURL:"https://private-school-chat.firebaseio.com",projectId:"private-school-chat",storageBucket:"private-school-chat.appspot.com",messagingSenderId:"113930891891",appId:"1:113930891891:web:88a3cb1a24e25b06017006"});var O=s.a.auth(),R=s.a.firestore();var F=function(){var e=new URLSearchParams(window.location.search).get("room");console.log(e),""!==e&&null!==e||(e="_start");var t=Object(n.useRef)(),a=R.collection(e),c=a.orderBy("createdAt").limitToLast(50),r=Object(m.a)(c,{idField:"id"}),i=Object(l.a)(r,1)[0],u=Object(n.useState)(0),p=Object(l.a)(u,2),d=(p[0],p[1]),h=function(){var e=Object(I.a)(y.a.mark((function e(){var t,n,o,c,r,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=O.currentUser,n=t.uid,o=t.photoURL,c=O.currentUser.displayName,r=w,l=document.getElementById("MSGINPUT").value,document.getElementById("MSGINPUT").value="",""!==l){e.next=7;break}return e.abrupt("return");case 7:return w="",e.next=10,a.add({text:l,createdAt:s.a.firestore.FieldValue.serverTimestamp(),uid:n,photoURL:o,name:c,attatchment:r});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){t.current.scrollIntoView();document.addEventListener("keydown",(function(e){"Enter"===e.code&&e.shiftKey&&(console.log("Enter key was pressed. Run your function."),e.preventDefault(),h(document.getElementById("MSGINPUT")))}))}),[i]),o.a.createElement(o.a.Fragment,null,o.a.createElement("main",null,o.a.createElement(g,{onUpdate:function(e,t){d(e)}}),i&&i.map((function(e){return o.a.createElement(L,{key:e.id,message:e})})),o.a.createElement("div",{className:"messageBar"},o.a.createElement("form",{onInputCapture:function(){t.current.scrollIntoView()}},o.a.createElement("textarea",{id:"MSGINPUT",onSubmit:h,placeholder:"Shift + enter or button to message\nDouble enter for new line",autoComplete:"none"}),o.a.createElement("button",{onClick:h,type:"submit"},o.a.createElement("span",{role:"img","aria-label":"Send Message"},"\ud83d\udce4"))),o.a.createElement(S,null))),o.a.createElement("span",{ref:t}))},T=a(50),x=a(51),M=a.n(x),P=a(52),D=a.n(P);a(143);var z=function(e){var t=e.userName;return"Ciara Lee"===t&&(t="Ciara Lee, the cutest person in the whole world!"),o.a.createElement("div",{id:"startRoom"},o.a.createElement("h1",null,"Welcome!"),o.a.createElement("p",null,"Signed in as ",t),o.a.createElement("h2",null,"Notice"),o.a.createElement("p",null,"By using this application, you grant it permission to use cookies.",o.a.createElement("br",null),"You can be banned from this application for any reason and might not be given and explaination."))};s.a.apps.length?s.a.app():s.a.initializeApp({apiKey:"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg",authDomain:"private-school-chat.firebaseapp.com",databaseURL:"https://private-school-chat.firebaseio.com",projectId:"private-school-chat",storageBucket:"private-school-chat.appspot.com",messagingSenderId:"113930891891",appId:"1:113930891891:web:88a3cb1a24e25b06017006"});var G=s.a.auth(),Y=!0,W=function(){console.log("Tab is in focus"),Y=!0,0,document.getElementById("favicon").href="/p-chat/favicon.ico",document.title="Planner"},K=function(){console.log("Tab is blurred"),Y=!1},q=function(){return Object(n.useEffect)((function(){return window.addEventListener("focus",W),window.addEventListener("blur",K),W(),function(){window.removeEventListener("focus",W),window.removeEventListener("blur",K)}}),[]),o.a.createElement(o.a.Fragment,null)},H=new M.a(D.a,{volume:1,throttleMs:100});function Q(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(z,{userName:G.currentUser.displayName}),o.a.createElement(F,null))}var Z=function(){var e=Object(T.a)(G),t=Object(l.a)(e,1)[0],a=Object(n.useState)("Rooms"),c=Object(l.a)(a,2),r=c[0],i=c[1];function s(e,t){console.log(e,t)}var m=new URLSearchParams(window.location.search).get("room");return console.log(m),o.a.createElement("div",{className:"App"},o.a.createElement("header",null,o.a.createElement("h1",null,"Chat"),o.a.createElement("div",{className:"buttoncontainer"},t?o.a.createElement("button",{onClick:function(){i("Rooms"),function(e){var t=e.onUpdate;"flex"!==document.getElementById("overlay").style&&(document.getElementById("overlay").style.display="flex"),"flex"===document.getElementById("overlay").style&&(document.getElementById("overlay").style.display="none",t(Math.floor(9567444*Math.random())+1,u))}(s)},className:"sign-out"},r):null,o.a.createElement(E,null))),o.a.createElement("section",null,t?o.a.createElement(o.a.Fragment,null,null===m?o.a.createElement(Q,null):o.a.createElement(F,null)):o.a.createElement(v,null)),o.a.createElement(q,null))};r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Z,null)),document.getElementById("root"))},52:function(e,t,a){e.exports=a.p+"static/media/noti.bdc711f4.wav"},53:function(e,t,a){e.exports=a(144)},58:function(e,t,a){},59:function(e,t,a){}},[[53,1,2]]]);
//# sourceMappingURL=main.8000a578.chunk.js.map