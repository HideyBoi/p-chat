(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{155:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(52),c=n.n(o),i=(n(63),n(31)),l=n.n(i),s=n(53),u=n(14),m=(n(65),n(54)),d=n.n(m),g=n(8),p=n.n(g),f=(n(144),n(146),n(147),n(148),n(55)),v=n(32),h=n(56),E=n.n(h),b=n(57),y=n.n(b);p.a.apps.length?p.a.app():p.a.initializeApp({apiKey:"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg",authDomain:"private-school-chat.firebaseapp.com",databaseURL:"https://private-school-chat.firebaseio.com",projectId:"private-school-chat",storageBucket:"private-school-chat.appspot.com",messagingSenderId:"113930891891",appId:"1:113930891891:web:88a3cb1a24e25b06017006"});var w=p.a.auth(),j=p.a.firestore(),k=p.a.messaging();Notification.requestPermission().then((function(){console.log("Got permission to recive notifications"),"serviceWorker"in navigator&&navigator.serviceWorker.register("../p-chat/firebase-messaging-sw.js").then((function(e){console.log("Registration successful, scope is:",e.scope),k.getToken({vapidKey:"BJpP6JS8xn9lkBrB0M88LmpChsj46h4YjIoW6rrdgf6rpsl1nWvZ1nBGT7-qyKFmlhdguDvzzcMLXlX4SItN_9k",serviceWorkerRegistration:e}).then((function(e){e?(console.log("current token for client: ",e),e):console.log("No registration token available. Request permission to generate one.")})).catch((function(e){console.log("An error occurred while retrieving token. ",e)}))})).catch((function(e){console.log("Service worker registration failed, error:",e)}))})).catch((function(){console.log("Permission denied.")}));var N="_start",O=!0,S=0,I=function(){console.log("Tab is in focus"),O=!0,S=0,document.getElementById("favicon").href="/hbd-games/p-chat/favicon.ico",document.title="Planner"},x=function(){console.log("Tab is blurred"),O=!1},B=function(){return Object(a.useEffect)((function(){return window.addEventListener("focus",I),window.addEventListener("blur",x),I(),function(){window.removeEventListener("focus",I),window.removeEventListener("blur",x)}}),[]),r.a.createElement(r.a.Fragment,null)},C=new E.a(y.a,{volume:1,throttleMs:100});function L(){return r.a.createElement("div",{id:"overlay"},r.a.createElement("div",{id:"overlayText"},r.a.createElement(A,null)))}function A(){var e=j.collection("rooms").orderBy("createdAt"),t=Object(v.a)(e,{idField:"id"}),n=Object(u.a)(t,1)[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"roomList"},r.a.createElement("div",{className:"roomtex"},"Close the room list by hitting the room button to apply changes."),n&&n.map((function(e){return r.a.createElement(F,{key:e.id,message:e})}))))}function F(e){var t=e.message,n=t.roomName,a=t.roomSysName;return console.log("message"),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){N=a}},n)))}function P(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"sign-in",onClick:function(){var e=new p.a.auth.GoogleAuthProvider;w.signInWithPopup(e)}},"Sign In"),r.a.createElement("div",{className:"opening-text"},"If you cannot see any messages upon logging in, check your internet connection.",r.a.createElement("br",null)," If that does not work, chances are this service has reached it's 'quota' and will no longer function until the next day."))}function R(){return w.currentUser&&r.a.createElement("button",{className:"sign-out",onClick:M},"Sign Out")}function M(){w.signOut()}function T(){var e=Object(a.useRef)(),t=j.collection(N),n=t.orderBy("createdAt").limitToLast(50),o=Object(v.a)(n,{idField:"id"}),c=Object(u.a)(o,1)[0],i=Object(a.useState)(""),m=Object(u.a)(i,2),d=m[0],g=m[1],f=function(){var e=Object(s.a)(l.a.mark((function e(n){var a,r,o,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),a=w.currentUser,r=a.uid,o=a.photoURL,c=w.currentUser.displayName,e.next=5,t.add({text:d,createdAt:p.a.firestore.FieldValue.serverTimestamp(),uid:r,photoURL:o,name:c});case 5:g("");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){(e.current.scrollIntoView({behavior:"smooth"}),C.play(),O)||(S+=1,document.title="("+S+") Planner",document.getElementById("favicon").href="/hbd-games/p-chat/favicon-unread.ico")}),[c]),r.a.createElement(r.a.Fragment,null,r.a.createElement("main",null,r.a.createElement(L,null),c&&c.map((function(e){return r.a.createElement(U,{key:e.id,message:e})}))),r.a.createElement("span",{ref:e}),r.a.createElement("form",{onSubmit:f},r.a.createElement("input",{value:d,onChange:function(e){return g(e.target.value)},placeholder:"Say something poggers"}),r.a.createElement("button",{type:"submit",disabled:!d},"\ud83d\udce4")))}function U(e){var t,n=Object(a.useRef)(),o=Object(a.useState)(""),c=Object(u.a)(o,2),i=(c[0],c[1],e.message),l=i.text,s=i.uid,m=i.photoURL,g=i.createdAt,p=i.name,f=s===w.currentUser.uid?"sent":"received";t=void 0!==p?p!==w.currentUser.displayName?p+" \u2022 ":"You \u2022 ":"Name missing \u2022 ";var v="Sending...",h="";if(null!=g){(v=new Date(g.toDate())).toDateString();var E=v.toTimeString().split(":"),b=" ";if(E[0]>=13){var y=parseInt(E[0]);y-=12,E[0]=y.toString(),b="PM"}else b="AM";v="".concat(v.toDateString(),"  ").concat(E[0],":").concat(E[1]," ").concat(b)}return h="sent"===f?"tssent":"tsreceived",r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message ".concat(f)},r.a.createElement("img",{alt:"Profile",src:m||"https://hideyboi.github.io/hideyboidev/p-chat/missingProfilePicture.png"}),r.a.createElement("div",{className:"MessageContainer"},r.a.createElement(d.a,null,l))),r.a.createElement("div",{className:"timestam ".concat(h),margin:"0px",padding:"0px"},t,v),r.a.createElement("span",{ref:n}))}var D=function(){var e=Object(f.a)(w),t=Object(u.a)(e,1)[0],n=Object(a.useState)(1),o=Object(u.a)(n,2),c=o[0],i=o[1];return r.a.createElement("div",{className:"App"},r.a.createElement("header",null,r.a.createElement("h1",null,"Chat"),r.a.createElement("div",{className:"buttoncontainer"},t?r.a.createElement("button",{onClick:function(){var e=Math.floor(9567444*Math.random())+1;console.log("Current: "+c),i(e),console.log("New: "+c),"flex"!==document.getElementById("overlay").style.display?document.getElementById("overlay").style.display="flex":document.getElementById("overlay").style.display="none"},className:"sign-out"},"Room"):null,r.a.createElement(R,null))),r.a.createElement("section",null,t?r.a.createElement(T,null):r.a.createElement(P,null)),r.a.createElement(B,null))};n(149);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(D,null)),document.getElementById("root"))},57:function(e,t,n){e.exports=n.p+"static/media/noti.bdc711f4.wav"},58:function(e,t,n){e.exports=n(155)},63:function(e,t,n){},65:function(e,t,n){}},[[58,1,2]]]);
//# sourceMappingURL=main.8b605197.chunk.js.map