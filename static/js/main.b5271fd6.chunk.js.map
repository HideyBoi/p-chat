{"version":3,"sources":["Componets/RoomList.js","Componets/Auth.js","Componets/FileUpload.js","Componets/ChatMessage.js","App.js","Componets/ChatRoom.js","Start.js","index.js","noti.wav"],"names":["room","firebase","apps","length","app","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","firestore","RoomList","query","collection","orderBy","useCollectionData","idField","messages","className","map","msg","RoomButton","key","id","message","props","roomName","roomSysName","onClick","window","location","replace","RoomSelect","URLSearchParams","search","get","console","log","auth","SignIn","provider","GoogleAuthProvider","signInWithPopup","SignOut","currentUser","signOut","imageToAttach","UploadButton","useState","uploadStatus","setUploadStatus","type","onChange","e","document","getElementsByClassName","files","storageRef","storage","ref","rng","Math","floor","random","child","put","then","snapshot","getDownloadURL","url","getElementById","style","display","role","aria-label","prevMsgType","prevMsgTime","messageCount","prevMsgUUID","ChatMessage","username","dummy","useRef","text","uid","photoURL","createdAt","name","attatchment","messageClass","alreadyPlayed","setPlayed","currentMsgPos","push","noti","play","focused","messagesSinceLastOpen","title","href","useEffect","timestamp","undefined","minDiff","toDate","error","displayName","timestampClass","tsTimeSplit","Date","toTimeString","split","pmAm","tsInt","parseInt","toString","toDateString","alt","src","target","ChatRoom","messagesRef","limitToLast","setRAND","sendMessage","a","preventDefault","imgurl","tex","value","add","FieldValue","serverTimestamp","current","scrollIntoView","addEventListener","event","code","shiftKey","onUpdate","rngtoset","roomtoset","onInputCapture","onSubmit","placeholder","autoComplete","StartScreen","currentName","userName","onFocus","onBlur","WindowFocusHandler","removeEventListener","UIfx","sound","volume","throttleMs","Start","App","useAuthState","user","roomButtonName","setButtonName","update","rom","switchRoom","ReactDOM","render","StrictMode","module","exports"],"mappings":"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","file":"static/js/main.b5271fd6.chunk.js","sourcesContent":["import React, {useState} from \"react\";\r\n\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/firestore';\r\n\r\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\r\n\r\nexport var room = \"_start\";\r\nexport var roomDisplayName = \"\";\r\n\r\nif (!firebase.apps.length) {\r\n\tfirebase.initializeApp({\r\n    \tapiKey: \"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg\",\r\n    \tauthDomain: \"private-school-chat.firebaseapp.com\",\r\n\t\tdatabaseURL: \"https://private-school-chat.firebaseio.com\",\r\n    \tprojectId: \"private-school-chat\",\r\n    \tstorageBucket: \"private-school-chat.appspot.com\",\r\n    \tmessagingSenderId: \"113930891891\",\r\n    \tappId: \"1:113930891891:web:88a3cb1a24e25b06017006\"\r\n\t});\r\n} else {\r\n\tfirebase.app(); // if already initialized, use that one\r\n}\r\n\r\nconst firestore = firebase.firestore();\r\n\r\nexport var roomButtonNamed = \"Rooms\"\r\n\r\nfunction RoomSelect() {\r\n\r\n    const queryParams = new URLSearchParams(window.location.search);\r\n    const id = queryParams.get('room');\r\n    console.log(id);\r\n    room = id;\r\n\r\n    return (\r\n        <div id=\"overlay\">\r\n            <div id=\"overlayText\"><RoomList/></div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction RoomList() {\r\n    const messagesRef = firestore.collection(\"rooms\");\r\n    const query = messagesRef.orderBy('createdAt');\r\n\r\n    const [messages] = useCollectionData(query, { idField: 'id' });\r\n\r\n    return (<>\r\n        <div className=\"roomList\">\r\n            <div className=\"overlaytex\">Select a room</div>\r\n            {messages && messages.map(msg => <RoomButton key={msg.id} message={msg} />)}\r\n\r\n        </div>\r\n    </>)\r\n}\r\n\r\nfunction RoomButton(props) {\r\n    const { roomName, roomSysName } = props.message;\r\n\r\n    function SetRoom() {\r\n        room = roomSysName;\r\n        roomDisplayName = roomName;\r\n\r\n        window.location.replace('/p-chat/?room='+roomSysName);\r\n    }\r\n\r\n    return (<>\r\n        <div>\r\n            <button onClick={SetRoom}>{roomName}</button>\r\n        </div>\r\n    </>)\r\n}\r\n\r\nexport function switchRoom({onUpdate}) {\r\n    if (document.getElementById(\"overlay\").style !== \"flex\") {\r\n        document.getElementById(\"overlay\").style.display = \"flex\";\r\n    } \r\n    if (document.getElementById(\"overlay\").style === \"flex\") {\r\n        document.getElementById(\"overlay\").style.display = \"none\";\r\n\r\n        var rng = Math.floor(Math.random() * 9567444) + 1; \r\n        onUpdate(rng, room);\r\n    }\r\n}\r\n\r\nexport default RoomSelect;","import React from \"react\";\r\n\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\n\r\nif (!firebase.apps.length) {\r\n\tfirebase.initializeApp({\r\n    \tapiKey: \"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg\",\r\n    \tauthDomain: \"private-school-chat.firebaseapp.com\",\r\n\t\tdatabaseURL: \"https://private-school-chat.firebaseio.com\",\r\n    \tprojectId: \"private-school-chat\",\r\n    \tstorageBucket: \"private-school-chat.appspot.com\",\r\n    \tmessagingSenderId: \"113930891891\",\r\n    \tappId: \"1:113930891891:web:88a3cb1a24e25b06017006\"\r\n\t});\r\n} else {\r\n\tfirebase.app(); // if already initialized, use that one\r\n}\r\n\r\nconst auth = firebase.auth();\r\n\r\nexport function SignIn() {\r\n    const signInWithGoogle = () => {\r\n      const provider = new firebase.auth.GoogleAuthProvider();\r\n      auth.signInWithPopup(provider);\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <button className=\"sign-in\" onClick={signInWithGoogle}>Sign In</button>\r\n        <div className=\"opening-text\">If you cannot sign in, please check your pop-up blocker and internet connection.</div>\r\n  </>)\r\n}\r\n\r\nexport function SignOut() {\r\n\r\n    function RemoveAuth() {\r\n        auth.signOut();\r\n    }\r\n\r\n    return auth.currentUser && (\r\n      <button className=\"sign-out\" onClick={RemoveAuth}>Sign Out</button>\r\n    )\r\n}","import React, { useState } from 'react';\r\n\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/firestore';\r\nimport 'firebase/storage';\r\n\r\nif (!firebase.apps.length) {\r\n\tfirebase.initializeApp({\r\n    \tapiKey: \"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg\",\r\n    \tauthDomain: \"private-school-chat.firebaseapp.com\",\r\n\t\tdatabaseURL: \"https://private-school-chat.firebaseio.com\",\r\n    \tprojectId: \"private-school-chat\",\r\n    \tstorageBucket: \"private-school-chat.appspot.com\",\r\n    \tmessagingSenderId: \"113930891891\",\r\n    \tappId: \"1:113930891891:web:88a3cb1a24e25b06017006\"\r\n\t});\r\n} else {\r\n\tfirebase.app(); // if already initialized, use that one\r\n}\r\n\r\n\r\nexport var imageToAttach = \"\"\r\n\r\nfunction UploadButton () {\r\n    const [uploadStatus, setUploadStatus] = useState(\"\");\r\n\r\n    function showUpload() {\r\n      document.getElementById(\"imgurUpload\").style.display = \"block\"\r\n    }\r\n\r\n    function closeUpload() {\r\n      document.getElementById(\"imgurUpload\").style.display = \"none\"\r\n    }\r\n\r\n    function upload() {\r\n      const e = document.getElementsByClassName('input-image')[0].files[0]\r\n\r\n        var storageRef = firebase.storage().ref();\r\n\r\n        console.log(e.type);\r\n\r\n        var rng = Math.floor(Math.random() * 69696969 + 1);\r\n\r\n        setUploadStatus(\"Uploading!\")\r\n\r\n        storageRef.child(\"images/\" + rng).put(e).then(function(snapshot) {\r\n            snapshot.ref.getDownloadURL().then(function(url) {\r\n              imageToAttach = url;\r\n              setUploadStatus(\"File uploaded! The next message you send will have this attachment, refresh now to cancel!\");\r\n            })\r\n        });\r\n    }\r\n\r\n    return(<>\r\n        <div id='imgurUpload'>\r\n            <div id='imgurUploadInner'>\r\n                <h2>Upload image</h2>\r\n                <form>\r\n                  <input type=\"file\" className='input-image' onChange={upload}/>\r\n                </form>\r\n                <p>{uploadStatus}</p>\r\n                <button onClick={closeUpload}>Close</button>\r\n            </div>\r\n        </div>\r\n        <button onClick={showUpload}><span role=\"img\" aria-label='Attatch file'>â¬†</span></button>\r\n    </>)\r\n}\r\n\r\nexport function ClearImgAttach () {\r\n    imageToAttach = \"\";\r\n}\r\n\r\nexport default UploadButton;","import React, { useEffect, useRef, useState } from 'react';\r\n\r\nimport ReactMarkdown from 'react-markdown';\r\n\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/firestore';\r\nimport 'firebase/auth';\r\n\r\nimport {noti, focused, messagesSinceLastOpen, incMsgOpen} from '../App'\r\n\r\n\r\nexport var prevMsgType = [];\r\nexport var prevMsgTime = [];\r\nexport var messageCount = 0;\r\nexport var prevMsgUUID = [];\r\n\r\nif (!firebase.apps.length) {\r\n\tfirebase.initializeApp({\r\n    \tapiKey: \"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg\",\r\n    \tauthDomain: \"private-school-chat.firebaseapp.com\",\r\n\t\tdatabaseURL: \"https://private-school-chat.firebaseio.com\",\r\n    \tprojectId: \"private-school-chat\",\r\n    \tstorageBucket: \"private-school-chat.appspot.com\",\r\n    \tmessagingSenderId: \"113930891891\",\r\n    \tappId: \"1:113930891891:web:88a3cb1a24e25b06017006\"\r\n\t});\r\n} else {\r\n\tfirebase.app(); // if already initialized, use that one\r\n}\r\n\r\nconst auth = firebase.auth();\r\n\r\nfunction ChatMessage(props) {\r\n  \tconst dummy = useRef();\r\n  \tconst { text, uid, photoURL, createdAt, name, attatchment } = props.message;\r\n\r\n  \tconst messageClass = uid === auth.currentUser.uid ? 'sent' : 'received';\r\n  \tconst [alreadyPlayed, setPlayed] = useState(false);\r\n\r\n  \tvar username;\r\n\r\n  \tvar currentMsgPos = messageCount;\r\n\r\n  \tprevMsgType.push(messageClass);\r\n  \tprevMsgTime.push(createdAt);\r\n  \tprevMsgUUID.push(uid);\r\n  \tmessageCount = messageCount + 1;\r\n\r\n  \tif (messageClass === \"received\") {\r\n    \tif (!alreadyPlayed) {\r\n      \tnoti.play();\r\n      \tsetPlayed(true);\r\n\r\n      \tif (!focused) {\r\n        \tincMsgOpen();\r\n        \tdocument.title = \"(\" + messagesSinceLastOpen + \") Planner\";\r\n        \tconst icon = document.getElementById(\"favicon\")\r\n        \ticon.href = \"/p-chat/favicon-unread.ico\";\r\n      \t}\r\n    \t}\r\n  \t}\r\n\r\n  \t//eslint-disable-next-line\r\n  \tuseEffect(function() {\r\n    \tif (currentMsgPos < 1 || timestamp === \"Sending...\") {\r\n      \treturn;\r\n    \t}\r\n    \tif (createdAt !== undefined && prevMsgTime[currentMsgPos - 1] !== null && prevMsgTime[currentMsgPos - 1] !== undefined){\r\n      \tvar minDiff = Math.floor((createdAt.toDate() - prevMsgTime[currentMsgPos - 1].toDate())/1000/60)\r\n    \t}\r\n\r\n    \tif (messageClass === prevMsgType[currentMsgPos - 1] && prevMsgUUID[currentMsgPos - 1] === uid && minDiff < 1) {\r\n      \tvar e = document.getElementById(\"timestamp\" + (currentMsgPos - 1));\r\n      \ttry {\r\n        \te.style.display = \"none\";\r\n        \tconsole.log(\"Changed\");\r\n      \t} catch (error) {\r\n      \t}\r\n    \t}\r\n  \t});\r\n\r\n  \tif (name !== undefined){\r\n    \tif (name !== auth.currentUser.displayName)\r\n    \t{\r\n      \t\tusername = name + \" â€¢ \";\r\n    \t} else {\r\n      \t\tusername = \"You â€¢ \"\r\n      \t\tif (name === \"Ciara Lee\") {\r\n        \t\tusername = \"You, aka the cutest person ever â€¢ \"\r\n      \t\t}\r\n    \t}\r\n  \t} else {\r\n    \tusername = \"Name missing â€¢ \";\r\n  \t}\r\n\r\n  \tvar timestamp = 'Sending...';\r\n  \tvar timestampClass = '';\r\n\r\n  \tif (createdAt != null) {\r\n    \ttimestamp = new Date(createdAt.toDate());\r\n    \tvar tsTime = timestamp.toTimeString();\r\n\r\n    \tvar tsTimeSplit = tsTime.split(':');\r\n\r\n    \tvar pmAm = ' ';\r\n\r\n    \tif (tsTimeSplit[0] >= 13) {\r\n      \tvar tsInt = parseInt(tsTimeSplit[0]);\r\n      \ttsInt = tsInt - 12;\r\n      \ttsTimeSplit[0] = tsInt.toString();\r\n      \tpmAm = 'PM';\r\n    \t} else {\r\n      \tpmAm = 'AM';\r\n    \t}\r\n\r\n    \ttimestamp = `${timestamp.toDateString()}  ${tsTimeSplit[0]}:${tsTimeSplit[1]} ${pmAm}`\r\n  \t}\r\n\r\n  \tif (messageClass === 'sent'){\r\n    \ttimestampClass = 'tssent';\r\n  \t} else {\r\n    \ttimestampClass = 'tsreceived';\r\n  \t}\r\n\r\n  \treturn (<>\r\n    \t<div className={`message ${messageClass}`}>\r\n      \t<img alt=\"Profile\" src={photoURL || 'https://hideyboi.github.io/p-chat/missingProfilePicture.png'} />\r\n        \t{timestamp === \"Sending...\" ? \r\n\t\t\t\t<img alt=\"sending\" src='/p-chat/loading.gif'></img>\r\n        \t:\r\n        \t\t<>{text ? \r\n\t\t\t\t\t<div className='MessageContainer'>\r\n        \t\t\t\t<div className=\"messageText\"><ReactMarkdown>{text}</ReactMarkdown></div>\r\n      \t\t\t\t</div>\r\n     \t\t\t: \r\n\t\t\t\t \t<span></span>\r\n\t\t\t\t}\r\n       \t\t</>}\r\n    \t</div>\r\n    \t{attatchment ? \r\n      \t\t<div className={\"attatchmentContainer \" + messageClass}>\r\n        \t<a className=\"attatchment\" href={attatchment} target=\"_empty\" alt=\"Open Attatchment in new tab\">\r\n          \t\t<img alt='attatchment' src={attatchment} />\r\n        \t</a> \r\n      \t\t</div>\r\n    \t: \r\n      \t\t<span></span>\r\n    \t}\r\n\r\n    \t<div id={\"timestamp\" + currentMsgPos} className={`timestamp ${timestampClass}`}>{username}{timestamp}</div>\r\n    \t<span ref={dummy}></span>\r\n  \t</>)\r\n}\r\n\r\nexport default ChatMessage;","import React, { useEffect, useState } from 'react';\r\nimport './App.css';\r\n\r\nimport {room, switchRoom} from './Componets/RoomList'\r\nimport {SignIn, SignOut} from './Componets/Auth';\r\nimport ChatRoom from \"./Componets/ChatRoom\"\r\n\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/firestore';\r\nimport 'firebase/auth';\r\n\r\nimport { useAuthState } from 'react-firebase-hooks/auth';\r\n\r\n\r\nimport UIfx from 'uifx';\r\nimport sound from './noti.wav';\r\nimport StartScreen from './Start'\r\n\r\nif (!firebase.apps.length) {\r\n\tfirebase.initializeApp({\r\n    \tapiKey: \"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg\",\r\n    \tauthDomain: \"private-school-chat.firebaseapp.com\",\r\n\t\tdatabaseURL: \"https://private-school-chat.firebaseio.com\",\r\n    \tprojectId: \"private-school-chat\",\r\n    \tstorageBucket: \"private-school-chat.appspot.com\",\r\n    \tmessagingSenderId: \"113930891891\",\r\n    \tappId: \"1:113930891891:web:88a3cb1a24e25b06017006\"\r\n\t});\r\n} else {\r\n\tfirebase.app(); // if already initialized, use that one\r\n}\r\n\r\nconst auth = firebase.auth();\r\n\r\nexport var focused = true;\r\nexport var messagesSinceLastOpen = 0;\r\n\r\n//#region \r\nconst onFocus = () => {\r\n  \tconsole.log(\"Tab is in focus\");\r\n  \tfocused = true;\r\n \tmessagesSinceLastOpen = 0;\r\n \tconst favicon = document.getElementById(\"favicon\")\r\n \tfavicon.href = \"/p-chat/favicon.ico\";\r\n\tdocument.title = \"Planner\"\r\n};\r\nconst onBlur = () => {\r\n\tconsole.log(\"Tab is blurred\");\r\n\tfocused = false;\r\n};\r\nconst WindowFocusHandler = () => {\r\n  \tuseEffect(() => {\r\n    \twindow.addEventListener(\"focus\", onFocus);\r\n      \twindow.addEventListener(\"blur\", onBlur);\r\n      \tonFocus();\r\n\r\n      \treturn () => {\r\n          \twindow.removeEventListener(\"focus\", onFocus);\r\n          \twindow.removeEventListener(\"blur\", onBlur);\r\n      \t};\r\n}, []);\r\n\r\n  \treturn <></>;\r\n};\r\n\r\nexport const noti = new UIfx(\r\n  \tsound,\r\n  \t{\r\n    \tvolume: 1, // number between 0.0 ~ 1.0\r\n    \tthrottleMs: 100\r\n  \t}\r\n)\r\n//#endregion\r\n\r\nfunction App() {\r\n\r\n  \tconst [user] = useAuthState(auth);\r\n\r\n\tconst [roomButtonName, setButtonName] = useState(\"Rooms\")\r\n\r\n\tfunction RoomButtonClicked() {\r\n\t\tif (roomButtonName == \"Rooms\") {\r\n\t\t\tsetButtonName(\"Rooms\");\r\n\t\t} else {\r\n\t\t\tsetButtonName(\"Rooms\")\r\n\t\t}\r\n\t\tswitchRoom(update);\r\n\t}\r\n\r\n\tfunction update(rng, rom) {\r\n\t\tconsole.log(rng, rom);\r\n\t}\r\n\r\n\tconst queryParams = new URLSearchParams(window.location.search);\r\n    const id = queryParams.get('room');\r\n    console.log(id);\r\n\r\n  \treturn (\r\n    \t<div className=\"App\">\r\n      \t<header>\r\n        \t<h1>Chat</h1>\r\n        \t<div className='buttoncontainer'>\r\n          \t{user ? <button onClick={RoomButtonClicked}  className=\"sign-out\">{roomButtonName}</button> : null}\r\n          \t<SignOut />\r\n        \t</div>\r\n      \t</header>\r\n\r\n      \t<section>\r\n        \t{user ? <>{id === null ? <Start /> : <ChatRoom />}</> : <SignIn />}\r\n      \t</section>\r\n      \t<WindowFocusHandler></WindowFocusHandler>\r\n    \t</div>\r\n  \t);\r\n}\r\n\r\nfunction Start() {\r\n  \treturn(<>\r\n    \t<StartScreen userName={auth.currentUser.displayName} />\r\n    \t<ChatRoom />\r\n  \t</>)\r\n}\r\n\r\nexport function incMsgOpen() {\r\n\tmessagesSinceLastOpen += 1;\r\n}\r\n\r\nexport default App;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\n\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/firestore';\r\n\r\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\r\nimport { roomDisplayName } from './RoomList';\r\n\r\nimport UploadButton, { imageToAttach, ClearImgAttach } from './FileUpload';\r\n\r\nimport ChatMessage from './ChatMessage'\r\n\r\nimport RoomSelect from './RoomList';\r\n\r\nif (!firebase.apps.length) {\r\n\tfirebase.initializeApp({\r\n    \tapiKey: \"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg\",\r\n    \tauthDomain: \"private-school-chat.firebaseapp.com\",\r\n\t\tdatabaseURL: \"https://private-school-chat.firebaseio.com\",\r\n    \tprojectId: \"private-school-chat\",\r\n    \tstorageBucket: \"private-school-chat.appspot.com\",\r\n    \tmessagingSenderId: \"113930891891\",\r\n    \tappId: \"1:113930891891:web:88a3cb1a24e25b06017006\"\r\n\t});\r\n} else {\r\n\tfirebase.app(); // if already initialized, use that one\r\n}\r\n\r\nconst auth = firebase.auth();\r\nconst firestore = firebase.firestore();\r\n\r\nfunction ChatRoom() {\r\n    const queryParams = new URLSearchParams(window.location.search);\r\n    var id = queryParams.get('room');\r\n    console.log(id);\r\n\r\n    if (id === \"\" || id === null) {\r\n        id = \"_start\"    \r\n    }\r\n\r\n    const dummy = useRef();\r\n    const messagesRef = firestore.collection(id);\r\n    const query = messagesRef.orderBy('createdAt').limitToLast(50);\r\n\r\n    const [messages] = useCollectionData(query, { idField: 'id' });\r\n\r\n    const [RAND, setRAND] = useState(0);\r\n\r\n    const sendMessage = async (e) => {\r\n        console.log(e);\r\n        e.preventDefault();\r\n\r\n        const { uid, photoURL } = auth.currentUser;\r\n        var username = auth.currentUser.displayName;\r\n        var imgurl = imageToAttach;\r\n  \r\n        var tex = document.getElementById(\"MSGINPUT\").value;\r\n        document.getElementById(\"MSGINPUT\").value = \"\";\r\n\r\n        if (tex === \"\") {\r\n            return;\r\n        }\r\n\r\n        ClearImgAttach();\r\n\r\n        await messagesRef.add({\r\n            text: tex,\r\n            createdAt: firebase.firestore.FieldValue.serverTimestamp(),\r\n            uid,\r\n            photoURL,\r\n            name: username,\r\n            attatchment: imgurl\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        dummy.current.scrollIntoView();\r\n        const listener = event => {\r\n            if (event.code === \"Enter\" && event.shiftKey) {\r\n                console.log(\"Enter key was pressed. Run your function.\");\r\n                event.preventDefault();\r\n                sendMessage(event);\r\n            }\r\n        };\r\n        document.addEventListener(\"keydown\", listener);\r\n    }, [messages])\r\n\r\n    function inputInteracted () {\r\n        dummy.current.scrollIntoView();\r\n    }\r\n\r\n    function update(rngtoset, roomtoset) {\r\n        setRAND(rngtoset);\r\n    }\r\n\r\n    return (<>\r\n        <main>\r\n            <RoomSelect onUpdate={update} />\r\n            {messages && messages.map(msg => <ChatMessage key={msg.id} message={msg} />)}\r\n            <div className='messageBar'>\r\n                <form onInputCapture={inputInteracted}>\r\n                <textarea id=\"MSGINPUT\" onSubmit={sendMessage} placeholder={\"Shift + enter or button to message\\nDouble enter for new line\"} autoComplete=\"none\" />\r\n                <button onClick={sendMessage} type=\"submit\"><span role=\"img\" aria-label='Send Message'>ðŸ“¤</span></button>\r\n                </form>\r\n                <UploadButton />\r\n            </div>\r\n        </main>\r\n        <span ref={dummy}></span>\r\n    </>)\r\n}\r\nexport default ChatRoom;","import React from \"react\";\r\nimport './Start.css';\r\n\r\nfunction StartScreen (props) {\r\n    var currentName = props.userName;\r\n\r\n    if (currentName === \"Ciara Lee\") {\r\n        currentName = \"Ciara Lee, the cutest person in the whole world!\"\r\n    }\r\n\r\n    return(<div id=\"startRoom\">\r\n        <h1>Welcome!</h1>\r\n        <p>Signed in as {currentName}</p>\r\n        <h2>Notice</h2>\r\n        <p>\r\n            By using this application, you grant it permission to use cookies.<br/>\r\n            You can be banned from this application for any reason and might not be given and explaination.\r\n        </p>\r\n    </div>)\r\n}\r\n\r\nexport default StartScreen;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n","module.exports = __webpack_public_path__ + \"static/media/noti.bdc711f4.wav\";"],"sourceRoot":""}