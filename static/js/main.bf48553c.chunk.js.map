{"version":3,"sources":["Start.js","App.js","index.js","noti.wav"],"names":["StartScreen","props","currentName","userName","id","href","firebase","apps","length","app","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","auth","firestore","room","roomDisplayName","focused","messagesSinceLastOpen","imageToAttach","onFocus","console","log","document","getElementById","title","onBlur","WindowFocusHandler","useEffect","window","addEventListener","removeEventListener","noti","UIfx","sound","volume","throttleMs","Start","currentUser","displayName","ChatRoom","RoomSelect","RoomList","query","collection","orderBy","useCollectionData","idField","messages","className","map","msg","RoomButton","key","message","roomName","roomSysName","onClick","SignIn","provider","GoogleAuthProvider","signInWithPopup","SignOut","RemoveAuth","signOut","dummy","useRef","messagesRef","limitToLast","useState","formValue","setFormValue","sendMessage","e","a","preventDefault","uid","photoURL","username","formVal","imgurl","add","text","createdAt","FieldValue","serverTimestamp","name","attatchment","current","scrollIntoView","play","ChatMessage","onInputCapture","value","onSubmit","onChange","inputChanged","target","placeholder","type","disabled","role","aria-label","ImgurUploadButton","ref","setShow","uploadStatus","setUploadStatus","u","r","XMLHttpRequest","d","FormData","getElementsByClassName","files","append","open","setRequestHeader","onreadystatechange","status","readyState","res","JSON","parse","responseText","data","onerror","send","style","display","messageClass","undefined","timestamp","timestampClass","tsTimeSplit","Date","toDate","toTimeString","split","pmAm","tsInt","parseInt","toString","toDateString","alt","src","margin","padding","App","useAuthState","user","stateRoom","setRoom","roomButtonName","setButtonName","rng","Math","floor","random","ReactDOM","render","StrictMode","module","exports"],"mappings":"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","file":"static/js/main.bf48553c.chunk.js","sourcesContent":["import React from \"react\";\r\nimport './Start.css';\r\n\r\nfunction StartScreen (props) {\r\n    var currentName = props.userName;\r\n\r\n    if (currentName === \"Ciara Lee\") {\r\n        currentName = \"Ciara Lee, the cutest person in the whole world!\"\r\n    }\r\n\r\n    return(<div id=\"startRoom\">\r\n        <h1>Welcome!</h1>\r\n        <p>Signed in as {currentName}</p>\r\n        <h2>Terms of Service</h2>\r\n        <p>\r\n            1. Harassment of any kind will result in a ban.<br/>\r\n            2. Markdown is fully supported<br/>\r\n            3. I don't care if this explodes your computer, that is not my problem, don't sue me.<br/>\r\n            4. Any questions? <a href=\"mailto:HideyBoiDev@gmail.com\">Use this email.</a>\r\n        </p>\r\n    </div>)\r\n}\r\n\r\nexport default StartScreen;","import React, { useEffect, useRef, useState } from 'react';\r\nimport './App.css';\r\n\r\nimport ReactMarkdown from 'react-markdown';\r\n\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/firestore';\r\nimport 'firebase/auth';\r\nimport 'firebase/analytics';\r\nimport 'firebase/messaging';\r\n\r\n\r\nimport { useAuthState } from 'react-firebase-hooks/auth';\r\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\r\n\r\n\r\nimport UIfx from 'uifx';\r\nimport sound from './noti.wav';\r\nimport StartScreen from './Start'\r\n\r\nif (!firebase.apps.length) {\r\n  firebase.initializeApp({\r\n      apiKey: \"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg\",\r\n      authDomain: \"private-school-chat.firebaseapp.com\",\r\n      databaseURL: \"https://private-school-chat.firebaseio.com\",\r\n      projectId: \"private-school-chat\",\r\n      storageBucket: \"private-school-chat.appspot.com\",\r\n      messagingSenderId: \"113930891891\",\r\n      appId: \"1:113930891891:web:88a3cb1a24e25b06017006\"\r\n  })\r\n}else {\r\n  firebase.app(); // if already initialized, use that one\r\n}\r\n\r\nconst auth = firebase.auth();\r\nconst firestore = firebase.firestore();\r\n\r\n\r\n\r\n/*\r\nconst messaging = firebase.messaging();\r\n\r\nvar msgToken = null;\r\n\r\n\r\nNotification.requestPermission()\r\n.then(function() {\r\n  console.log(\"Got permission to recive notifications\")\r\n  \r\n  if (\"serviceWorker\" in navigator) {\r\n    navigator.serviceWorker\r\n      .register('../p-chat/firebase-messaging-sw.js')\r\n      .then(function(registration) {\r\n        console.log(\"Registration successful, scope is:\", registration.scope);\r\n        messaging.getToken({vapidKey: 'BJpP6JS8xn9lkBrB0M88LmpChsj46h4YjIoW6rrdgf6rpsl1nWvZ1nBGT7-qyKFmlhdguDvzzcMLXlX4SItN_9k', serviceWorkerRegistration : registration })\r\n          .then((currentToken) => {\r\n            if (currentToken) {\r\n              console.log('current token for client: ', currentToken);\r\n    \r\n              msgToken = currentToken;\r\n              console.log(msgToken);\r\n\r\n              firestore.collection(\"msgToken\").doc(auth.currentUser.uid).set({\r\n                token: currentToken\r\n              });\r\n            } else {\r\n              console.log('No registration token available. Request permission to generate one.');\r\n    \r\n              // shows on the UI that permission is required \r\n            }\r\n          }).catch((err) => {\r\n            console.log('An error occurred while retrieving token. ', err);\r\n            // catch error while creating client token\r\n          });  \r\n        })\r\n        .catch(function(err) {\r\n          console.log(\"Service worker registration failed, error:\"  , err );\r\n      }); \r\n    }\r\n})\r\n.catch(function() {\r\n  console.log(\"Permission denied.\")\r\n});\r\n*/\r\n\r\n\r\nvar room = \"_start\";\r\nvar roomDisplayName = \"START\";\r\n\r\nvar focused = true;\r\nvar messagesSinceLastOpen = 0;\r\n\r\nvar imageToAttach = \"\";\r\n\r\nconst onFocus = () => {\r\n  console.log(\"Tab is in focus\");\r\n  focused = true;\r\n  messagesSinceLastOpen = 0;\r\n  const favicon = document.getElementById(\"favicon\")\r\n  favicon.href = \"/p-chat/favicon.ico\";\r\n  document.title = \"Planner\"\r\n};\r\nconst onBlur = () => {\r\n  console.log(\"Tab is blurred\");\r\n  focused = false;\r\n};\r\nconst WindowFocusHandler = () => {\r\n  useEffect(() => {\r\n      window.addEventListener(\"focus\", onFocus);\r\n      window.addEventListener(\"blur\", onBlur);\r\n      // Calls onFocus when the window first loads\r\n      onFocus();\r\n      // Specify how to clean up after this effect:\r\n      return () => {\r\n          window.removeEventListener(\"focus\", onFocus);\r\n          window.removeEventListener(\"blur\", onBlur);\r\n      };\r\n}, []);\r\n\r\n  return <></>;\r\n};\r\nconst noti = new UIfx(\r\n  sound,\r\n  {\r\n    volume: 1, // number between 0.0 ~ 1.0\r\n    throttleMs: 100\r\n  }\r\n)\r\n\r\nfunction App() {\r\n\r\n  const [user] = useAuthState(auth);\r\n\r\n  const [stateRoom, setRoom] = useState(1);\r\n\r\n  const [roomButtonName, setButtonName] = useState(\"Rooms\")\r\n\r\n\r\n  function RoomSwitch() { \r\n    var rng = Math.floor(Math.random() * 9567444) + 1; \r\n\r\n    if (roomButtonName === \"Rooms\") {\r\n      setButtonName(\"Close Rooms Menu\");\r\n    } else {\r\n      setButtonName(\"Rooms\");\r\n    }\r\n\r\n    console.log('Current: ' + stateRoom);\r\n    setRoom(rng);\r\n    console.log('New: ' + stateRoom);\r\n    switchRoom();\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header>\r\n        <h1>Chat</h1>\r\n        <div className='buttoncontainer'>\r\n          {user ? <button onClick={RoomSwitch} className=\"sign-out\">{roomButtonName}</button> : null}\r\n          <SignOut />\r\n        </div>\r\n      </header>\r\n\r\n      <section>\r\n        {user ? <>{room === \"_start\" ? <Start /> : <ChatRoom />}</> : <SignIn />}\r\n      </section>\r\n      <WindowFocusHandler></WindowFocusHandler>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Start() {\r\n  return(<>\r\n    <StartScreen userName={auth.currentUser.displayName} />\r\n    <ChatRoom />\r\n  </>)\r\n}\r\n\r\nfunction RoomSelect() {\r\n  return (\r\n    <div id=\"overlay\">\r\n      <div id=\"overlayText\"><RoomList /></div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction RoomList() {\r\n  const messagesRef = firestore.collection(\"rooms\");\r\n  const query = messagesRef.orderBy('createdAt');\r\n\r\n  const [messages] = useCollectionData(query, { idField: 'id' });\r\n\r\n  return (<>\r\n    <div className=\"roomList\">\r\n\r\n      <div className='roomtex'>Close the room list by hitting the room button to apply changes.</div>\r\n\r\n      {messages && messages.map(msg => <RoomButton key={msg.id} message={msg} />)}\r\n\r\n    </div>\r\n  </>)\r\n}\r\n\r\nfunction RoomButton(props) {\r\n  const { roomName, roomSysName } = props.message;\r\n  console.log(\"message\");\r\n\r\n  function SetRoom() {\r\n    room = roomSysName;\r\n    roomDisplayName = roomName;\r\n  }\r\n\r\n  /*\r\n  firestore.collection(roomSysName + \"-msg\").doc(auth.currentUser.uid).get().then((doc) => {\r\n    if (doc.exists){\r\n      setNotiButton(\"Subbed\");\r\n    } else {\r\n      setNotiButton(\"Not Subbed\");\r\n    }\r\n  })\r\n\r\n  const [notiButton, setNotiButton] = useState(\"Not Subbed\");\r\n  function clickedNotiButton() {\r\n    if (notiButton === \"Not Subbed\") {\r\n      var uid = auth.currentUser.uid;\r\n      firestore.collection(roomSysName + \"-msg\").doc(auth.currentUser.uid).set({\r\n        name: uid\r\n      });\r\n      setNotiButton('Subbed');\r\n    } else {\r\n      firestore.collection(roomSysName + \"-msg\").doc(auth.currentUser.uid).delete();\r\n      setNotiButton('Not Subbed');\r\n    }\r\n  }\r\n  */\r\n\r\n  //<button onClick={clickedNotiButton}>{notiButton}</button>\r\n\r\n  return (<>\r\n    <div>\r\n      <button onClick={SetRoom}>{roomName}</button>\r\n    </div>\r\n  </>)\r\n}\r\n\r\nfunction switchRoom() {\r\n  \r\n  if (document.getElementById(\"overlay\").style.display !== \"flex\") {\r\n    document.getElementById(\"overlay\").style.display = \"flex\";\r\n  } else {\r\n    document.getElementById(\"overlay\").style.display = \"none\";\r\n  } \r\n}\r\n\r\nfunction SignIn() {\r\n\r\n  const signInWithGoogle = () => {\r\n    const provider = new firebase.auth.GoogleAuthProvider();\r\n    auth.signInWithPopup(provider);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <button className=\"sign-in\" onClick={signInWithGoogle}>Sign In</button>\r\n      <div className=\"opening-text\">If you cannot sign in, please check your pop-up blocker and internet connection.</div>\r\n    </>\r\n  )\r\n\r\n}\r\n\r\nfunction SignOut() {\r\n  \r\n  return auth.currentUser && (\r\n    <button className=\"sign-out\" onClick={RemoveAuth}>Sign Out</button>\r\n  )\r\n}\r\n\r\nfunction RemoveAuth() {\r\n  auth.signOut();\r\n}\r\n\r\n\r\nfunction ChatRoom() {\r\n  const dummy = useRef();\r\n  const messagesRef = firestore.collection(room);\r\n  const query = messagesRef.orderBy('createdAt').limitToLast(50);\r\n\r\n  const [messages] = useCollectionData(query, { idField: 'id' });\r\n\r\n  const [formValue, setFormValue] = useState('');\r\n\r\n  const sendMessage = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const { uid, photoURL } = auth.currentUser;\r\n    var username = auth.currentUser.displayName;\r\n    var formVal = formValue;\r\n    var imgurl = imageToAttach;\r\n    imageToAttach = \"\"\r\n    setFormValue('');\r\n    await messagesRef.add({\r\n      text: formVal,\r\n      createdAt: firebase.firestore.FieldValue.serverTimestamp(),\r\n      uid,\r\n      photoURL,\r\n      name: username,\r\n      attatchment: imgurl\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    dummy.current.scrollIntoView();\r\n    noti.play();\r\n    if (!focused) {\r\n      messagesSinceLastOpen += 1;\r\n      document.title = \"(\" + messagesSinceLastOpen + \") Planner\";\r\n      const icon = document.getElementById(\"favicon\")\r\n      icon.href = \"/p-chat/favicon-unread.ico\";\r\n    }\r\n  }, [messages])\r\n\r\n  function inputInteracted () {\r\n    dummy.current.scrollIntoView();\r\n  }\r\n\r\n  function inputChanged(e) {\r\n    setFormValue(e)\r\n    dummy.current.scrollIntoView();\r\n  }\r\n\r\n  return (<>\r\n    <main>\r\n        <RoomSelect/>\r\n        {messages && messages.map(msg => <ChatMessage key={msg.id} message={msg} />)}\r\n        <div className='messageBar'>\r\n          <form onInputCapture={inputInteracted}>\r\n            <input value={formValue} onSubmit={sendMessage} onChange={(e) => inputChanged(e.target.value)} placeholder={\"Message \" + roomDisplayName} />\r\n            <button onClick={sendMessage} type=\"submit\" disabled={!formValue}><span role=\"img\" aria-label='Send Message'>ðŸ“¤</span></button>\r\n          </form>\r\n          <ImgurUploadButton />\r\n        </div>\r\n    </main>\r\n    <span ref={dummy}></span>\r\n  </>)\r\n}\r\n\r\nfunction ImgurUploadButton () {\r\n\r\n  const [isImgurScreenShow, setShow] = useState(false);\r\n  const [uploadStatus, setUploadStatus] = useState(\"\");\r\n\r\n  function showUpload() {\r\n    document.getElementById(\"imgurUpload\").style.display = \"block\"\r\n    setShow(true);\r\n  }\r\n\r\n  function closeUpload() {\r\n    document.getElementById(\"imgurUpload\").style.display = \"none\"\r\n    setShow(false);\r\n  }\r\n\r\n  function upload() {\r\n    const r = new XMLHttpRequest()\r\n    const d = new FormData()\r\n    const e = document.getElementsByClassName('input-image')[0].files[0]\r\n    var u\r\n  \r\n    setUploadStatus(\"Uploading image...\");\r\n\r\n    d.append('image', e)\r\n  \r\n    r.open('POST', 'https://api.imgur.com/3/image')\r\n    r.setRequestHeader('Authorization', `Client-ID cb4d8f29a6eaf8c`)\r\n    r.onreadystatechange = function () {\r\n      if(r.status === 200 && r.readyState === 4) {\r\n        let res = JSON.parse(r.responseText)\r\n        u = `https://i.imgur.com/${res.data.id}.png`\r\n        imageToAttach = u\r\n        console.log(\"Uploaded to \" + u);\r\n        setUploadStatus(\"Uploaded! This image will be attatched to the next message you send, refresh the page now to cancel.\")\r\n      }\r\n    }\r\n    r.onerror = function () {\r\n      setUploadStatus(\"An error has occured, check that the desired file is something that can be uploaded to imgur and is also not too large!\")\r\n    }\r\n    r.send(d)\r\n  }\r\n\r\n  return(<>\r\n    <div id='imgurUpload'>\r\n      <div id='imgurUploadInner'>\r\n        <p>Images are hosted on Imgur!</p>\r\n        <form>\r\n          <input type=\"file\" className='input-image' onChange={upload}/>\r\n        </form>\r\n        <p>{uploadStatus}</p>\r\n        <button onClick={closeUpload}>Close</button>\r\n      </div>\r\n    </div>\r\n    <button onClick={showUpload}><span role=\"img\" aria-label='Attatch file'>â¬†</span></button>\r\n  </>)\r\n}\r\n\r\nfunction ChatMessage(props) {\r\n  const dummy = useRef();\r\n  const { text, uid, photoURL, createdAt, name, attatchment } = props.message;\r\n\r\n  const messageClass = uid === auth.currentUser.uid ? 'sent' : 'received';\r\n\r\n  var username;\r\n\r\n  if (name !== undefined){\r\n    if (name !== auth.currentUser.displayName)\r\n    {\r\n      username = name + \" â€¢ \";\r\n    } else {\r\n      username = \"You â€¢ \"\r\n    }\r\n  } else {\r\n    username = \"Name missing â€¢ \";\r\n  }\r\n  \r\n    \r\n\r\n  var timestamp = 'Sending...';\r\n  var timestampClass = '';\r\n\r\n  if (createdAt != null) {\r\n    timestamp = new Date(createdAt.toDate());\r\n    var tsTime = timestamp.toTimeString();\r\n\r\n    var tsTimeSplit = tsTime.split(':');\r\n\r\n    var pmAm = ' ';\r\n\r\n    if (tsTimeSplit[0] >= 13) {\r\n      var tsInt = parseInt(tsTimeSplit[0]);\r\n      tsInt = tsInt - 12;\r\n      tsTimeSplit[0] = tsInt.toString();\r\n      pmAm = 'PM';\r\n    } else {\r\n      pmAm = 'AM';\r\n    }\r\n\r\n    timestamp = `${timestamp.toDateString()}  ${tsTimeSplit[0]}:${tsTimeSplit[1]} ${pmAm}`\r\n    \r\n  }\r\n\r\n  if (messageClass === 'sent'){\r\n    timestampClass = 'tssent';\r\n  } else {\r\n    timestampClass = 'tsreceived';\r\n  }\r\n\r\n  return (<>\r\n    <div className={`message ${messageClass}`}>\r\n      <img alt=\"Profile\" src={photoURL || 'https://hideyboi.github.io/p-chat/missingProfilePicture.png'} />\r\n      {text ? <div className='MessageContainer'>\r\n        <div className=\"messageText\"><ReactMarkdown>{text}</ReactMarkdown></div>\r\n      </div> : <span></span>}\r\n\r\n    </div>\r\n    {attatchment ? \r\n      <div className={\"attatchmentContainer \" + messageClass}>\r\n        <a className=\"attatchment\" href={attatchment} target=\"_empty\" alt=\"Open Attatchment in new tab\">\r\n          <img alt='attatchment' src={attatchment} />\r\n        </a> \r\n      </div>\r\n    : \r\n      <span></span>\r\n    }\r\n    <div className={`timestamp ${timestampClass}`} margin=\"0px\" padding=\"0px\">{username}{timestamp}</div>\r\n    <span ref={dummy}></span>\r\n  </>)\r\n}\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n","module.exports = __webpack_public_path__ + \"static/media/noti.bdc711f4.wav\";"],"sourceRoot":""}