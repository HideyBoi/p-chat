(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{145:function(e,t,a){},146:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(47),c=a.n(l),o=(a(58),a(30)),i=a.n(o),s=a(48),m=a(8),u=(a(60),a(49)),d=a.n(u),p=a(13),g=a.n(p),E=(a(139),a(143),a(147),a(148),a(50)),f=a(31),h=a(51),v=a.n(h),b=a(52),y=a.n(b);a(145);var w=function(e){var t=e.userName;return"Ciara Lee"===t&&(t="Ciara Lee, the cutest person in the whole world!"),r.a.createElement("div",{id:"startRoom"},r.a.createElement("h1",null,"Welcome!"),r.a.createElement("p",null,"Signed in as ",t),r.a.createElement("h2",null,"Terms of Service"),r.a.createElement("p",null,"1. Harassment of any kind will result in a ban.",r.a.createElement("br",null),"2. Markdown is fully supported",r.a.createElement("br",null),"3. I don't care if this explodes your computer, that is not my problem, don't sue me.",r.a.createElement("br",null),"4. Any questions? ",r.a.createElement("a",{href:"mailto:HideyBoiDev@gmail.com"},"Use this email.")))};g.a.apps.length?g.a.app():g.a.initializeApp({apiKey:"AIzaSyBpWmtGTqluiA1gC0CEFHrQcZncNRYtjbg",authDomain:"private-school-chat.firebaseapp.com",databaseURL:"https://private-school-chat.firebaseio.com",projectId:"private-school-chat",storageBucket:"private-school-chat.appspot.com",messagingSenderId:"113930891891",appId:"1:113930891891:web:88a3cb1a24e25b06017006"});var N=g.a.auth(),O=g.a.firestore(),I="_start",j="START",C=!0,S=0,k="",U=function(){console.log("Tab is in focus"),C=!0,S=0,document.getElementById("favicon").href="/p-chat/favicon.ico",document.title="Planner"},x=function(){console.log("Tab is blurred"),C=!1},A=function(){return Object(n.useEffect)((function(){return window.addEventListener("focus",U),window.addEventListener("blur",x),U(),function(){window.removeEventListener("focus",U),window.removeEventListener("blur",x)}}),[]),r.a.createElement(r.a.Fragment,null)},B=new v.a(y.a,{volume:1,throttleMs:100});function R(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w,{userName:N.currentUser.displayName}),r.a.createElement(H,null))}function F(){return r.a.createElement("div",{id:"overlay"},r.a.createElement("div",{id:"overlayText"},r.a.createElement(T,null)))}function T(){var e=O.collection("rooms").orderBy("createdAt"),t=Object(f.a)(e,{idField:"id"}),a=Object(m.a)(t,1)[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"roomList"},r.a.createElement("div",{className:"roomtex"},"Close the room list by hitting the room button to apply changes."),a&&a.map((function(e){return r.a.createElement(L,{key:e.id,message:e})}))))}function L(e){var t=e.message,a=t.roomName,n=t.roomSysName;return console.log("message"),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){I=n,j=a}},a)))}function M(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"sign-in",onClick:function(){var e=new g.a.auth.GoogleAuthProvider;N.signInWithPopup(e)}},"Sign In"),r.a.createElement("div",{className:"opening-text"},"If you cannot sign in, please check your pop-up blocker and internet connection."))}function P(){return N.currentUser&&r.a.createElement("button",{className:"sign-out",onClick:D},"Sign Out")}function D(){N.signOut()}function H(){var e=Object(n.useRef)(),t=O.collection(I),a=t.orderBy("createdAt").limitToLast(50),l=Object(f.a)(a,{idField:"id"}),c=Object(m.a)(l,1)[0],o=Object(n.useState)(""),u=Object(m.a)(o,2),d=u[0],p=u[1],E=function(){var e=Object(s.a)(i.a.mark((function e(a){var n,r,l,c,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),n=N.currentUser,r=n.uid,l=n.photoURL,c=N.currentUser.displayName,o=d,s=k,k="",p(""),e.next=9,t.add({text:o,createdAt:g.a.firestore.FieldValue.serverTimestamp(),uid:r,photoURL:l,name:c,attatchment:s});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){(e.current.scrollIntoView(),B.play(),C)||(S+=1,document.title="("+S+") Planner",document.getElementById("favicon").href="/p-chat/favicon-unread.ico")}),[c]),r.a.createElement(r.a.Fragment,null,r.a.createElement("main",null,r.a.createElement(F,null),c&&c.map((function(e){return r.a.createElement(V,{key:e.id,message:e})})),r.a.createElement("div",{className:"messageBar"},r.a.createElement("form",{onInputCapture:function(){e.current.scrollIntoView()}},r.a.createElement("input",{value:d,onSubmit:E,onChange:function(t){return function(t){p(t),e.current.scrollIntoView()}(t.target.value)},placeholder:"Message "+j}),r.a.createElement("button",{onClick:E,type:"submit",disabled:!d},r.a.createElement("span",{role:"img","aria-label":"Send Message"},"\ud83d\udce4"))),r.a.createElement(q,null))),r.a.createElement("span",{ref:e}))}function q(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=(t[0],t[1]),l=Object(n.useState)(""),c=Object(m.a)(l,2),o=c[0],i=c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"imgurUpload"},r.a.createElement("div",{id:"imgurUploadInner"},r.a.createElement("p",null,"Images are hosted on Imgur!"),r.a.createElement("form",null,r.a.createElement("input",{type:"file",className:"input-image",onChange:function(){var e,t=new XMLHttpRequest,a=new FormData,n=document.getElementsByClassName("input-image")[0].files[0];i("Uploading image..."),a.append("image",n),t.open("POST","https://api.imgur.com/3/image"),t.setRequestHeader("Authorization","Client-ID cb4d8f29a6eaf8c"),t.onreadystatechange=function(){if(200===t.status&&4===t.readyState){var a=JSON.parse(t.responseText);e="https://i.imgur.com/".concat(a.data.id,".png"),k=e,console.log("Uploaded to "+e),i("Uploaded! This image will be attatched to the next message you send, refresh the page now to cancel.")}},t.onerror=function(){i("An error has occured, check that the desired file is something that can be uploaded to imgur and is also not too large!")},t.send(a)}})),r.a.createElement("p",null,o),r.a.createElement("button",{onClick:function(){document.getElementById("imgurUpload").style.display="none",a(!1)}},"Close"))),r.a.createElement("button",{onClick:function(){document.getElementById("imgurUpload").style.display="block",a(!0)}},r.a.createElement("span",{role:"img","aria-label":"Attatch file"},"\u2b06")))}function V(e){var t,a=Object(n.useRef)(),l=e.message,c=l.text,o=l.uid,i=l.photoURL,s=l.createdAt,m=l.name,u=l.attatchment,p=o===N.currentUser.uid?"sent":"received";t=void 0!==m?m!==N.currentUser.displayName?m+" \u2022 ":"You \u2022 ":"Name missing \u2022 ";var g="Sending...",E="";if(null!=s){var f=(g=new Date(s.toDate())).toTimeString().split(":"),h=" ";if(f[0]>=13){var v=parseInt(f[0]);v-=12,f[0]=v.toString(),h="PM"}else h="AM";g="".concat(g.toDateString(),"  ").concat(f[0],":").concat(f[1]," ").concat(h)}return E="sent"===p?"tssent":"tsreceived",r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message ".concat(p)},r.a.createElement("img",{alt:"Profile",src:i||"https://hideyboi.github.io/p-chat/missingProfilePicture.png"}),c?r.a.createElement("div",{className:"MessageContainer"},r.a.createElement("div",{className:"messageText"},r.a.createElement(d.a,null,c))):r.a.createElement("span",null)),u?r.a.createElement("div",{className:"attatchmentContainer "+p},r.a.createElement("a",{className:"attatchment",href:u,target:"_empty",alt:"Open Attatchment in new tab"},r.a.createElement("img",{alt:"attatchment",src:u}))):r.a.createElement("span",null),r.a.createElement("div",{className:"timestamp ".concat(E),margin:"0px",padding:"0px"},t,g),r.a.createElement("span",{ref:a}))}var z=function(){var e=Object(E.a)(N),t=Object(m.a)(e,1)[0],a=Object(n.useState)(1),l=Object(m.a)(a,2),c=l[0],o=l[1],i=Object(n.useState)("Rooms"),s=Object(m.a)(i,2),u=s[0],d=s[1];return r.a.createElement("div",{className:"App"},r.a.createElement("header",null,r.a.createElement("h1",null,"Chat"),r.a.createElement("div",{className:"buttoncontainer"},t?r.a.createElement("button",{onClick:function(){var e=Math.floor(9567444*Math.random())+1;d("Rooms"===u?"Close Rooms Menu":"Rooms"),console.log("Current: "+c),o(e),console.log("New: "+c),"flex"!==document.getElementById("overlay").style.display?document.getElementById("overlay").style.display="flex":document.getElementById("overlay").style.display="none"},className:"sign-out"},u):null,r.a.createElement(P,null))),r.a.createElement("section",null,t?r.a.createElement(r.a.Fragment,null,"_start"===I?r.a.createElement(R,null):r.a.createElement(H,null)):r.a.createElement(M,null)),r.a.createElement(A,null))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(z,null)),document.getElementById("root"))},52:function(e,t,a){e.exports=a.p+"static/media/noti.bdc711f4.wav"},53:function(e,t,a){e.exports=a(146)},58:function(e,t,a){},60:function(e,t,a){}},[[53,1,2]]]);
//# sourceMappingURL=main.bf48553c.chunk.js.map